<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card p-4 shadow-sm mb-3">
      <h4>Generate QR</h4>
      <form method="POST" action="/generate">
        <div class="mb-2"><input name="data" class="form-control" placeholder="Text or URL" required></div>
        <div class="d-flex gap-2">
          <button class="btn btn-primary">Generate</button>
          <button type="button" class="btn btn-secondary" onclick="toggleTheme()">Toggle Theme</button>
        </div>
      </form>
      {% if qr_b64 %}
        <div class="text-center mt-3">
          <img src="data:image/png;base64,{{ qr_b64 }}" style="width:200px;border-radius:8px;border:4px solid white;">
          <div class="mt-2"><a href="/download?data={{ raw }}" class="btn btn-success btn-sm">Download</a></div>
        </div>
      {% endif %}
    </div>

    <div class="card p-3 shadow-sm">
      <h4>Scan QR (camera)</h4>
      <div id="reader"></div>
      <div class="mt-2" id="scan-result">No scan yet</div>
    </div>

  </div>
</div>
<script>
function onScanSuccess(decodedText, decodedResult) {
  document.getElementById('scan-result').innerHTML = '<b>Scanned:</b> ' + decodedText;
  fetch('/api/save_scan', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({content:decodedText})});
}
new Html5QrcodeScanner('reader', {fps:10, qrbox:250}).render(onScanSuccess);
</script>